# TUI (Text User Interface) 設計

本ドキュメントは `gh-mutual-follow` アプリケーションにおけるTUIの設計の経緯を記述するものです。

## 機能概要

Bubble Teaフレームワークを利用して、ユーザーがGitHubのフォロー関係を直感的に操作できるTUIを提供します。UIは主に以下の要素で構成されます。

-   **ヘッダー**: ログイン中のGitHubアカウント名を表示します。
-   **2ペイン構成**:
    -   **左ペイン (Following)**: ユーザーが一方的にフォローしているアカウントのリスト。
    -   **右ペイン (Followers)**: ユーザーを一方的にフォローしているアカウントのリスト。
-   **フッター**: 操作可能なキーバインドのヘルプテキストを表示します。
-   **ステータスメッセージ**: アクション実行後のフィードバックを一時的に表示します。

## 実装内容

TUIの基本構造は `main.go` に実装されました。（リファクタリング後は `internal/tui` パッケージに分離されます）

### 状態管理 (`model` 構造体)

アプリケーションの全ての状態は `model` 構造体で管理されます。
-   ユーザー名、リストデータ（Following/Followers）
-   アクティブなペイン（左右どちらが選択されているか）
-   ローディング状態、エラー情報
-   UIのスタイル定義 (`lipgloss`)
-   一括処理中などの特殊な状態フラグ

### UIコンポーネントとスタイル

-   `bubbles/list`: 左右のペインのユーザーリスト表示に使用されます。
-   `lipgloss`: ヘッダー、ペインの境界線、テキストの色など、UI全体のスタイリングに利用されます。
-   `itemDelegate`: `bubbles/list` の各項目のレンダリングをカスタマイズするために実装されました。

### UIロジック (`Update` 関数)

`Update` 関数は、キー入力や非同期メッセージに応じてアプリケーションの状態を更新する責務を担います。

-   **ペイン切り替え**: `Tab` / `Shift+Tab` キーで左右のペインを切り替えます。
-   **データ更新**: `r` キーでデータを再読み込みします。
-   **個別アクション**: `Enter` キーで選択中のユーザーをフォローまたはアンフォローします。
-   **一括アクション**: `a` キーで現在アクティブなペインに表示されている全ユーザーを一括でフォローまたはアンフォローします。処理中は他の操作をブロックします。
-   **その他**: リストのカーソル移動、ページネーション (`←`/`→`) など。

### レイアウト調整

-   当初、リストの表示件数が環境によって崩れる問題がありましたが、`list.Model` の高さと `lipgloss` で描画するペインの高さを固定値で調整することで、常に10件のアイテムが表示されるように修正されました。

